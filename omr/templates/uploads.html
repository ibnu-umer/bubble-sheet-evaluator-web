<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>OMR Evaluation</title>
    </head>
    <body>
        <h1>OMR Evaluation</h1>

        {% if messages %}
        <ul>
            {% for m in messages %}
            <li>{{ m }}</li>
            {% endfor %}
        </ul>
        {% endif %}

        <!-- Section 1: Upload Sheet PDFs -->
        <h2>1. Upload Sheet PDFs</h2>
        <form method="post" enctype="multipart/form-data" action="{% url 'upload_file' %}">
            {% csrf_token %}
            <input type="hidden" name="file_type" value="sheet">
            <div>
                <label for="id_sheet_file">Choose Sheet PDF:</label>
                <input type="file" name="file" id="id_sheet_file" required>
            </div>
            <button type="submit">Upload Sheet</button>
        </form>

        <!-- Section 2: Upload Answer Key -->
        <h2>2. Upload Answer Key</h2>
        <form method="post" enctype="multipart/form-data" action="{% url 'upload_file' %}">
            {% csrf_token %}
            <input type="hidden" name="file_type" value="answer_key">
            <div>
                <label for="id_answer_file">Choose Answer Key File:</label>
                <input type="file" name="file" id="id_answer_file" required>
            </div>
            <button type="submit">Upload Answer Key</button>
        </form>

        <!-- Section 3: Select Uploaded Files -->
        <h2>3. Select Files to Process</h2>
        <form method="post" action="{% url 'evaluate' %}">
            {% csrf_token %}
            <div>
                <label for="sheet_select">Select Sheet PDFs:</label>
                <select name="sheet_files" id="sheet_select" multiple required>
                    {% for f in recent %}
                        {% if f.file_type == "sheet" %}
                            <option value="{{ f.file.path }}">{{ f.file.name }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
            </div>
            <div>
                <label for="answer_select">Select Answer Key:</label>
                <select name="answer_file" id="answer_select" required>
                    {% for f in recent %}
                        {% if f.file_type == "answer_key" %}
                            <option value="{{ f.file.path }}">{{ f.file.name }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
            </div>
            <button type="submit">Start Processing</button>
        </form>
    </body>
</html>

